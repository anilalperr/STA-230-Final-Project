---
title: "Pre-Analysis Final Project Testing"
author: "Ellis Chen"
date: "5/4/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(corrplot)
library(ggplot2)
library(caret)
library(tree)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
project_data <- read.csv("C7 IYSdata.csv", header=TRUE, na.strings=c(".","NA"))
#project_data = dplyr::select(C7.IYSdata, gender, time.work, time.HW, friends, safe, home.happy, best.school, grades, home.al.drug, time.no.adult, home.chores, home.support)

#Response Variables
#1. time HW: grade, 
# important variables:
#2. best school 
# important variables:
#3. grades
# important variables:

project_data[project_data == "1-2 hours"] = "2 or less hours"
project_data[project_data == "0 hours"] = "2 or less hours"
project_data[project_data == "6-10 hours"] = "6 or more hours"
project_data[project_data == "11 or more hours"] = "6 or more hours"

project_data[project_data == "Strongly agree"] = "Agree"
project_data[project_data == "Strongly disagree"] = "Disagree"

#Stacked bar charts
ggplot(project_data, aes(fill=grade, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=gender, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.work, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.no.adult, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=live, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=times.moved, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=now.living, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.friend, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.school.act, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.noschool.act, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.reading, x=time.HW)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=time.church, x=time.HW)) + geom_bar(position='stack')
```

```{R}
set.seed(123)
sub_project_data = dplyr::select(project_data, time.work, time.no.adult, time.friend, time.school.act, time.reading, time.church, time.excersize, time.HW)

#sub_project_data = na.omit(sub_project_data)

trainIndex = createDataPartition(sub_project_data$time.HW, p = 0.7, list = FALSE, times=1)

projectTrain = sub_project_data[trainIndex,]
projectTest = sub_project_data[-trainIndex,]

project.model = train(time.HW ~., data=projectTrain, ntree=100)

project.pred = predict(project.model, projectTest)
with(projectTest, table(project.pred, time.HW))
```


