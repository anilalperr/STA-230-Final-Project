---
title: "Pre-Analysis Final Project Testing"
author: "Ellis Chen"
date: "5/4/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(corrplot)
library(ggplot2)
library(caret)
library(tree)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
C7.IYSdata <- read.csv("~/Downloads/STA-230-Final-Project-main 3/C7 IYSdata.csv", header=TRUE, na.strings=c(".","NA"))

C7.IYSdata = dplyr::select(C7.IYSdata, gender, time.work, time.HW, friends, safe, home.happy, best.school, grades, home.al.drug, time.no.adult, home.chores, home.support)

project_data = na.omit(C7.IYSdata)
head(project_data)

ggplot(project_data, aes(fill=home.happy, x=best.school)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=friends, x=best.school)) + geom_bar(position='stack')
ggplot(project_data, aes(fill=home.al.drug, x=best.school)) + geom_bar(position='stack')


ggplot(project_data, aes(fill=home.happy, x=time.HW)) + geom_bar(position='stack')

```

```{R}
set.seed(123)
trainIndex = createDataPartition(project_data$best.school, p = 4/5, list = FALSE, times=1)

projectTrain = project_data[trainIndex,]
projectTest = project_data[-trainIndex,]

project.model = train(best.school ~., data=projectTrain, ntree=100)
```

```{r}
```
